 <!DOCTYPE html>
<html>
<head>
<title>Bullpen Tracker Elite</title>
<style>
body {
font-family: Arial;
margin: 0;
background: #eef2f7;
text-align: center;
}

#menuBtn {
font-size: 26px;
position: absolute;
left: 15px;
top: 10px;
cursor: pointer;
}

#sidebar {
position: fixed;
left: -220px;
top: 0;
width: 200px;
height: 100%;
background: #222;
color: white;
padding: 15px;
transition: 0.3s;
}

h1 { margin-top: 40px; }

select, input, button {
padding: 8px;
margin: 5px;
}

#zone {
display: grid;
grid-template-columns: repeat(5, 60px);
gap: 3px;
justify-content: center;
margin: 15px;
}

.cell {
background: white;
border: 1px solid black;
height: 60px;
cursor: pointer;
}

canvas {
margin-top: 10px;
border: 2px solid black;
background: white;
}
</style>
</head>

<body>

<div id="menuBtn" onclick="toggleMenu()">☰</div>

<div id="sidebar">
<h3>Pitchers</h3>
<select id="pitcherSelect"></select>
<input id="newPitcher" placeholder="Add pitcher">
<button onclick="addPitcher()">Add</button>
</div>

<h1>⚾ Bullpen Tracker Elite</h1>

<select id="pitchType">
<option>4-Seam</option>
<option>2-Seam</option>
<option>Slider</option>
<option>Curveball</option>
<option>Changeup</option>
</select>

<input id="velo" placeholder="Velo" type="number">

<div id="zone"></div>

<button onclick="drawHeatmap()">Heat Map</button>
<button onclick="showStats()">Stats</button>
<button onclick="exportCSV()">Export CSV</button>

<canvas id="chart" width="320" height="320"></canvas>

<script>
let pitches = JSON.parse(localStorage.getItem("bullpen")) || [];
let pitchers = JSON.parse(localStorage.getItem("pitchers")) || [];

const zone = document.getElementById("zone");
const pitcherSelect = document.getElementById("pitcherSelect");

/* COLORS */
const colors = {
"4-Seam": "red",
"2-Seam": "blue",
"Slider": "green",
"Curveball": "purple",
"Changeup": "orange"
};

/* MENU */
function toggleMenu() {
const bar = document.getElementById("sidebar");
bar.style.left = bar.style.left === "0px" ? "-220px" : "0px";
}

/* PITCHERS */
function loadPitchers() {
pitcherSelect.innerHTML = "";
pitchers.forEach(p => {
const opt = document.createElement("option");
opt.text = p;
pitcherSelect.add(opt);
});
}
loadPitchers();

function addPitcher() {
const name = document.getElementById("newPitcher").value;
if (!name) return;
pitchers.push(name);
localStorage.setItem("pitchers", JSON.stringify(pitchers));
loadPitchers();
}

/* ZONE */
for (let i = 0; i < 25; i++) {
const cell = document.createElement("div");
cell.classList.add("cell");
cell.onclick = () => savePitch(i);
zone.appendChild(cell);
}

function savePitch(loc) {
const pitch = {
pitcher: pitcherSelect.value,
type: document.getElementById("pitchType").value,
velo: document.getElementById("velo").value,
location: loc
};

pitches.push(pitch);
localStorage.setItem("bullpen", JSON.stringify(pitches));
}

/* HEATMAP */
function drawHeatmap() {
const canvas = document.getElementById("chart");
const ctx = canvas.getContext("2d");

ctx.clearRect(0,0,320,320);

let grid = Array(25).fill(0);

pitches.forEach(p => {
if (typeof p.location === "number") {
grid[p.location]++;
}
});

grid.forEach((val, i) => {
let col = i % 5;
let row = Math.floor(i/5);

let intensity = val * 20;
ctx.fillStyle = `rgba(255,0,0,${intensity/100})`;

ctx.fillRect(col*60, row*60, 60, 60);
});
}

/* STATS */
function showStats() {
let total = pitches.length;
let strikes = pitches.filter(p => typeof p.location === "number").length;

let percent = total ? ((strikes/total)*100).toFixed(1) : 0;

let breakdown = {};

pitches.forEach(p => {
breakdown[p.type] = (breakdown[p.type] || 0) + 1;
});

let text = `Total: ${total}\nStrike %: ${percent}%\n\n`;

for (let t in breakdown) {
text += `${t}: ${breakdown[t]}\n`;
}

alert(text);
}

/* EXPORT */
function exportCSV() {
let csv = "Pitcher,Type,Velo,Location\n";

pitches.forEach(p => {
csv += `${p.pitcher},${p.type},${p.velo},${p.location}\n`;
});

let blob = new Blob([csv], { type: 'text/csv' });
let a = document.createElement("a");

a.href = URL.createObjectURL(blob);
a.download = "bullpen.csv";
a.click();
}
</script>

</body>
</html>
