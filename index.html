// --- DRAW STRIKE ZONE WITH 3x3 GRID ---
function drawZone(){
  ctx.clearRect(0,0,320,420);
  ctx.strokeStyle="white"; 
  ctx.lineWidth=2;
  ctx.strokeRect(80,100,160,200); // Strike zone box

  // 3x3 grid
  const rows=3, cols=3;
  for(let r=1;r<rows;r++){
    ctx.beginPath();
    ctx.moveTo(80,100 + r*(200/rows));
    ctx.lineTo(240,100 + r*(200/rows));
    ctx.stroke();
  }
  for(let c=1;c<cols;c++){
    ctx.beginPath();
    ctx.moveTo(80 + c*(160/cols),100);
    ctx.lineTo(80 + c*(160/cols),300);
    ctx.stroke();
  }
}

// --- RECORD PITCH ---
zone.addEventListener("click",function(e){
  const pitcher=document.getElementById("pitcherSelect").value;
  if(!pitcher) return alert("Select pitcher");
  const rect=zone.getBoundingClientRect();
  const x=e.clientX-rect.left;
  const y=e.clientY-rect.top;
  const swingMiss=document.getElementById("swingMiss").checked;

  const pitch={x,y,type:document.getElementById("pitchType").value,date:new Date().toLocaleDateString(),swingMiss};
  if(!data[pitcher]) data[pitcher]=[];
  data[pitcher].push(pitch);

  // Update balls/strikes
  if(x>=80 && x<=240 && y>=100 && y<=300) pitchCount.strikes++;
  else if(swingMiss) pitchCount.strikes++;
  else pitchCount.balls++;

  if(pitchCount.strikes>=3){ alert("Strikeout!"); resetCount(); }
  if(pitchCount.balls>=4){ alert("Walk!"); resetCount(); }

  saveData();
  drawZone();
  drawPitchDot(x, y);   // Draw baseball dot
  drawHeat(); 
  updateStats(); 
  updateCountDisplay();
});

// --- DRAW PITCH DOT AS BASEBALL ---
function drawPitchDot(x, y){
  const radius = 8; // slightly bigger
  // outer circle
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(x,y,radius,0,Math.PI*2);
  ctx.fill();

  // red stitching lines
  ctx.strokeStyle="red";
  ctx.lineWidth=1;
  ctx.beginPath();
  ctx.arc(x,y,radius*0.8,0,Math.PI*2);
  ctx.stroke();
  
  // optional: add short stitching lines
  for(let angle=-Math.PI/4; angle<=Math.PI/4; angle+=Math.PI/8){
    const x1 = x + Math.cos(angle)*(radius*0.8);
    const y1 = y + Math.sin(angle)*(radius*0.8);
    const x2 = x + Math.cos(angle)*(radius*0.5);
    const y2 = y + Math.sin(angle)*(radius*0.5);
    ctx.beginPath();
    ctx.moveTo(x1,y1);
    ctx.lineTo(x2,y2);
    ctx.stroke();
  }
}
